# 论文复现总结(部分，因为还没跑出来)
## 阅读论文
在阅读论文的过程中，其实理论部分之前论文的内容都还是挺容易读懂的。主要就是总结了以往图像修复的方法，优缺点并列出了本模型所能解决的问题和大概组成。理论部分上就不太行了，但还是有一个大概的理解：   
这篇论文提出了一个**EdgeConnect**模型去修复图像，分为两个阶段：
1. 边缘生成器(Edge generator)
2. 图像完成网络(Image completion network)   

具体结构见下图：

![](总结图片/微信图片_20210208212330.png) 
 
整个模型的思路就是先生成边缘线条，再进行图像填充。整个网络有两个生成器（G1和G2），两个鉴别器（D1和D2）。生成器是基于编码器和解码器的那个模型模型搭建
的。一开始输入的是待修复模型的灰度图像和受损图像的边缘线条图像（这个好像是作为一个判断条件），经过G1卷积后将结果交给鉴别器鉴别，鉴别器通过比较对抗损失（一个值）来判断生成的完真整线条图是否是真实的，G2和D2是相似的思路

## 配置环境
这是Readme文档里的配置要求：

![](总结图片/9c54f402bb26d02416fe4d0dc682455.png)  

### Python 3 
这个电脑之前已经安装过了

![](总结图片/微信图片_20210209230811.png)  

### NVIDIA GPU + CUDA cuDNN
首桌面右键打开NIVIDIA控制面板自查了一下，自己电脑是有GPU的。

![](总结图片/微信图片_20210209232036.png)  

然后开始安装CUDA了，非常幸运的找到了一个教程：  

<https://blog.csdn.net/weixin_40313940/article/details/104152125>

然后我直达了[CUDA官网](https://developer.nvidia.com/rdp/cudnn-download)，按照官网和教程上的流程下载了CUDA11.1，选择自定义安装，在选项时取消了Visual Studio Integration选项（教程上说有安装VS2017的建议取消，虽然我安装的是2019版的，但我也取消了）。  
接着是**配置环境变量** ，手动把path添加到了环境变量中。

![](总结图片/微信图片_20210209235715.png) 

然后，就可以检查一下CUDA是否安装好了，在终端输入nvcc -V：

![](总结图片/微信图片_20210210000503.png) 

成功！

但是，在我去下cuDNN之前，我了解到Pytorch和CUDA之间存在这一个版本兼容问题，我上网查到CUDA11.1只能和Pytorch1.7兼容，但论文里好像要求的是Pytorch1.0。但是由于Pytorch0.4版本和1.0版本跨度比较大，1.0版本之后就没听说过有什么兼容问题了。于是可以放心的下载cuDNN了。

[到达官网](https://developer.nvidia.com/cudnn),根据CUDA的版本选择了适合的cuDNN，点击链接下载，但是安装包只有45B，点击压缩包也无法打开，重复试了几次之后，终于有一次进入了正常的下载页面，但是速度只有10kb/s，然后5kb/s，然后0B，最后504。

![](总结图片/微信图片_20210210003004.png) 

去网上搜了很多资料，但好像都没有一个很符合情况的解释。这个时候队友告诉我CUDA11.X的版本于所有的cuDNN版本是通用的并且发来了8.1版本的百度云链接：

![](总结图片/9c54f402bb26d02416fe4d0dc682455.png) 

所以，cuDNN也搞定了。
### Pytorch 
首先，打开官网，选择好相应的配置后，运行指令：

![](总结图片/微信图片_20210213234339.png) 

但是，果不其然没那么简单，一路飙红：

![](总结图片/微信图片_20210210232727.png)  
可以考虑换源，用镜像安装。于是我就去学了一下怎么换源，换了几次都失败了（我这里没有用临时换源而是设为默认）：

![](总结图片/微信图片_20210213235518.jpg)

![](总结图片/微信图片_20210213235459.jpg)  

终于在一篇blog上找到了原因：  
<https://blog.csdn.net/WannaSeaU/article/details/102830613?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.control&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.control>  

最重要的就是这句话：

![](总结图片/微信图片_20210210233559.png)

根据这个进行修改后，换源是成功了，但又出现了新的错误：  

![](总结图片/微信图片_20210210233807.png)

我将错误信息复制下来到百度上去搜，在简书找到了一篇跟我的问题很相似的教程： 

<https://www.jianshu.com/p/f54a01419330?utm_campaign=haruki>  

教程上也没有对这个错误有一个很肯定的解释，只是怀疑是网络问题，pip去下载安装对应的库，本质上也应该是去下载whl，所以直接去下载Pytorch的whl应该也是可以的。于是我就按照文章上面的步骤找
到了我需要的torch和torchvision的版本的whl并完成了下载。  
但我发现我好像没有wheel库：

![](总结图片/微信图片_20210210235201.png)

所以顺便 `pip install wheel `安装了一下。 然后用pip安装一下torch和torchvision。   
都完成之后，就可以安装Pytorch了，在终端输入`pip install pytorch`:

![](总结图片/微信图片_20210210235717.png)

![](总结图片/微信图片_20210210235733.png)
成功了！！！至此，配置环境结束。

## 复现代码
- 下载数据集：
- 生成训练
- 测试





